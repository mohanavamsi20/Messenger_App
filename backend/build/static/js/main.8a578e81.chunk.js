(this["webpackJsonpchat-cosey-front"]=this["webpackJsonpchat-cosey-front"]||[]).push([[0],{113:function(e,a){},116:function(e,a,t){},117:function(e,a,t){},118:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(54),o=t.n(c),s=t(8),l=t(11),m=t(7),i=t(18),u=t.n(i),d=u.a.mixin({showConfirmButton:!0,timer:2e3,onOpen:function(e){e.addEventListener("sans-serif",u.a.stopTimer),e.addEventListener("sans-serif",u.a.resumeTimer)}}),p=function(e,a){d.fire({title:a})},h=t(12),f=t.n(h),E=Object(m.f)((function(e){var a=r.a.createRef(),t=r.a.createRef();return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"cardHeader"},"Login"),r.a.createElement("div",{className:"cardBody"},r.a.createElement("div",{className:"inputGroup"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{type:"email",name:"email",id:"email",placeholder:"abc@example.com",ref:a})),r.a.createElement("div",{className:"inputGroup"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",name:"password",id:"password",placeholder:"Your Password",ref:t})),r.a.createElement("button",{onClick:function(){var n=a.current.value,r=t.current.value;f.a.post("http://localhost:8000/user/login",{email:n,password:r}).then((function(a){p("success",a.data.message),localStorage.setItem("CC_Token",a.data.token),e.history.push("/dashboard"),e.setupSocket()})).catch((function(e){e&&e.response&&e.response.data&&e.response.data.message&&p("error",e.response.data.message)}))}},"Login")))})),v=function(e){var a=r.a.createRef(),t=r.a.createRef(),n=r.a.createRef();return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"cardHeader"},"Registration"),r.a.createElement("div",{className:"cardBody"},r.a.createElement("div",{className:"inputGroup"},r.a.createElement("label",{htmlFor:"name"},"Name"),r.a.createElement("input",{type:"text",name:"name",id:"name",placeholder:"John Doe",ref:a})),r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{type:"email",name:"email",id:"email",placeholder:"abc@example.com",ref:t})),r.a.createElement("div",{className:"inputGroup"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",name:"password",id:"password",placeholder:"Your Password",ref:n})),r.a.createElement("button",{onClick:function(e){var r=a.current.value,c=t.current.value,o=n.current.value;f.a.post("http://localhost:8000/user/register",{name:r,email:c,password:o}).then((function(a){p("success",a.data.message),e.history.push("/login")})).catch((function(e){e&&e.response&&e.response.data&&e.response.data.message&&p("error",e.response.data.message)}))}},"Register"))},g=function(e){var a=r.a.useState([]),t=Object(s.a)(a,2),n=t[0],c=t[1];return r.a.useEffect((function(){!function e(){f.a.get("http://localhost:8000/chatroom",{headers:{Authorization:"Bearer "+localStorage.getItem("CC_Token")}}).then((function(e){c(e.data)})).catch((function(a){setTimeout(e,3e3)}))}()}),[]),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"cardHeader"},"Chatrooms"),r.a.createElement("div",{className:"cardBody"},r.a.createElement("div",{className:"inputGroup"},r.a.createElement("label",{htmlFor:"chatroomName"},"Chatroom Name"),r.a.createElement("input",{type:"text",name:"chatroomName",id:"chatroomName",placeholder:"ChatterBox Nepal"}))),r.a.createElement("button",null,"Create Chatroom"),r.a.createElement("div",{className:"chatrooms"},n.map((function(e){return r.a.createElement("div",{key:e._id,className:"chatroom"},r.a.createElement("div",null,e.name),r.a.createElement(l.b,{to:"/chatroom/"+e._id},r.a.createElement("div",{className:"join"},"Join")))}))))},N=function(e){return r.a.useEffect((function(){var a=localStorage.getItem("CC_Token");console.log(a),a?e.history.push("/dashboard"):e.history.push("/login")}),[0]),r.a.createElement("div",null)},b=t(58),C=Object(m.f)((function(e){var a=e.match,t=e.socket,n=a.params.id,c=r.a.useState([]),o=Object(s.a)(c,2),l=o[0],m=o[1],i=r.a.useRef(),u=r.a.useState(""),d=Object(s.a)(u,2),p=d[0],h=d[1];return r.a.useEffect((function(){var e=localStorage.getItem("CC_Token");if(e){var a=JSON.parse(atob(e.split(".")[1]));h(a.id)}t&&t.on("newMessage",(function(e){var a=[].concat(Object(b.a)(l),[e]);m(a)}))}),[l]),r.a.useEffect((function(){return t&&t.emit("joinRoom",{chatroomId:n}),function(){t&&t.emit("leaveRoom",{chatroomId:n})}}),[]),r.a.createElement("div",{className:"chatroomPage"},r.a.createElement("div",{className:"chatroomSection"},r.a.createElement("div",{className:"cardHeader"},"Chatroom Name"),r.a.createElement("div",{className:"chatroomContent"},l.map((function(e,a){return r.a.createElement("div",{key:a,className:"message"},r.a.createElement("span",{className:p===e.userId?"ownMessage":"otherMessage"},e.name,":")," ",e.message)}))),r.a.createElement("div",{className:"chatroomActions"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",name:"message",placeholder:"Say something!",ref:i})),r.a.createElement("div",null,r.a.createElement("button",{className:"join",onClick:function(){t&&(t.emit("chatroomMessage",{chatroomId:n,message:i.current.value}),i.current.value="")}},"Send")))))})),k=t(57),y=t.n(k);var w=function(){var e=r.a.useState(null),a=Object(s.a)(e,2),t=a[0],n=a[1],c=function e(){if(localStorage.getItem("CC_Token")&&!t){var a=y()("http://localhost:8000",{query:{token:localStorage.getItem("CC_Token")}});a.on("disconnect",(function(){n(null),setTimeout(e,3e3),p("error","Socket Disconnected!")})),a.on("connect",(function(){p("success","Socket Connected!")})),n(a)}};return r.a.useEffect((function(){c()}),[]),r.a.createElement(l.a,null,r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/",component:N,exact:!0}),r.a.createElement(m.a,{path:"/login",render:function(){return r.a.createElement(E,{setupSocket:c})},exact:!0}),r.a.createElement(m.a,{path:"/register",component:v,exact:!0}),r.a.createElement(m.a,{path:"/dashboard",render:function(){return r.a.createElement(g,{socket:t})},exact:!0}),r.a.createElement(m.a,{path:"/chatroom/:id",render:function(){return r.a.createElement(C,{socket:t})},exact:!0})))};t(116),t(117);o.a.render(r.a.createElement(w,null),document.getElementById("root"))},59:function(e,a,t){e.exports=t(118)}},[[59,1,2]]]);
//# sourceMappingURL=main.8a578e81.chunk.js.map